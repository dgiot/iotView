(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-474892a8"],{"015f":function(e,t,a){},"06ca":function(e,t,a){},"0815":function(e,t,a){"use strict";a("e3cf")},"178e":function(e,t,a){},"1ad1":function(e,t,a){"use strict";a("c734")},"1b4a":function(e,t,a){"use strict";a("e528")},2202:function(e,t,a){},"264a":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"liveapp"},[a("div",[a("span",{staticStyle:{"margin-left":"5%",padding:"2px 10px","margin-top":"10px","border-left":"4px solid #5dc7ff",display:"inline-block",color:"#00d7ff"}},[e._v("现场画面")]),a("span",{staticClass:"custom-btn btn-14 blue",on:{click:function(t){return e.play()}}},[e._v("播放")]),a("span",{staticClass:"custom-btn btn-14 red",on:{click:function(t){return e.pause()}}},[e._v("暂停")])]),a("div",{staticStyle:{margin:"10px auto",width:"90%",height:"calc(100% - 35px)"}},[!e.isShowMultiple&&e.show?[a("vue-aliplayer-v2",{ref:"VueAliplayerV2",staticStyle:{height:"90%"},attrs:{source:e.source,options:e.options,autoplay:!0,rePlay:!0}})]:e._e()],2),e.show?e._e():a("p",{staticClass:"remove-text"},[e._v("播放器已销毁!")])])},n=[],s=(a("caad"),a("2532"),a("5806")),c=a.n(s),r={name:"Live-Demo",components:{VueAliplayerV2:c.a.Player},props:{comp:{type:Object,default:function(){return{type:"videolive",width:400,hieght:72}}}},data:function(){return{liveSrc:[{label:"湖南卫视",value:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/hnwshd/4000000/mnf.m3u8"},{label:"播放源1",value:"//player.alicdn.com/video/aliyunmedia.mp4"}],options:{isLive:!0,rePlay:!0},source:"http://219.151.31.38/liveplay-kk.rtxapp.com/live/program/live/hnwshd/4000000/mnf.m3u8",show:!0,isShowMultiple:!1}},mounted:function(){console.log("地址",this.$FileServe),this.comp.text&&(this.comp.text.includes("//")?this.source=this.comp.text:this.source=this.$FileServe+this.comp.text),this.source.indexOf("m3u8")<0&&(this.options.isLive=!1)},methods:{play:function(){this.$refs.VueAliplayerV2.play()},pause:function(){this.$refs.VueAliplayerV2.pause()},replay:function(){this.$refs.VueAliplayerV2.replay()},getCurrentTime:function(){this.$refs.VueAliplayerV2.getCurrentTime()},getStatus:function(){var e=this.$refs.VueAliplayerV2.getStatus();console.log("getStatus:",e),alert("getStatus:".concat(e))},showMultiple:function(){this.isShowMultiple=!this.isShowMultiple}}},o=r,l=(a("f888"),a("2877")),d=Object(l["a"])(o,i,n,!1,null,"f7be4aba",null);t["a"]=d.exports},"2c89":function(e,t,a){"use strict";a("06ca")},"2dac":function(e,t,a){"use strict";a("90ce")},"32f9":function(e,t,a){"use strict";a("6cc1")},"41cb":function(e,t,a){"use strict";a("e05a7")},5137:function(e,t,a){},"59d7":function(e,t){e.exports="data:image/png;base64,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"},"624b":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dgiotnotification1",style:{width:"100%",height:"100%"}},[a("div",{staticClass:"noti_wrap",on:{mouseover:e.handlemouseOver,mouseleave:e.handlemouseLeave}},[a("div",{staticClass:"noti_wrap1"},e._l(e.warnList,(function(t,i){return a("div",{key:i,staticClass:"noti_wrap_item"},[a("div",{staticClass:"noti_wrap_item_content"},[e._v(" 报警信息:"),a("span",{class:0==t.status?"warning":"success"},[e._v(" "+e._s(t.content.alarm_message))])]),a("div",{staticClass:"noti_wrap_item_content"},[e._v(" 报警时间: "+e._s(e.utc2beijing(t.createdAt))+" ")])])})),0)])])},n=[],s=a("c7eb"),c=a("1da1"),r=(a("d3b7"),a("159b"),a("4569")),o=a("ed08"),l={name:"DgiotNotification1",props:{comp:{type:Object,default:function(){return{type:"line",width:400,hieght:72}}},selectdevice:{type:Object,default:function(){return{}}}},data:function(){return{warnList:[],queryData:{skip:0,limit:10,count:"objectId",order:"-createdAt",where:{}},timer:{},interal:""}},created:function(){var e=this;this.interal=setInterval((function(){e.fetchData()}),8e3)},mounted:function(){var e=this;setTimeout((function(){e.scroll()}),1500)},destroyed:function(){clearInterval(this.interal)},methods:{fetchData:function(){var e=arguments,t=this;return Object(c["a"])(Object(s["a"])().mark((function a(){var i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.length>0&&void 0!==e[0]?e[0]:{},t.selectdevice.objectId&&(t.queryData.where["content._deviceid"]={$regex:t.selectdevice.objectId}),a.next=4,Object(r["a"])(t.queryData);case 4:i=a.sent,i.results.forEach((function(e){var t,a;e.devicename=e.devicename||(null===(t=e.content)||void 0===t?void 0:t.devicename)||"",e.desc=e.desc||(null===(a=e.content)||void 0===a?void 0:a.errorname)||""})),t.warnList=i.results;case 7:case"end":return a.stop()}}),a)})))()},scroll:function(){var e=this,t=document.getElementsByClassName("noti_wrap")[0],a=document.getElementsByClassName("noti_wrap1")[0];a.scrollHeight>1.5*t.clientHeight&&(clearInterval(this.timer[e.comp.id]),this.timer[e.comp.id]=setInterval((function(){if(t.scrollTop>=a.scrollHeight)t.scrollTop=0;else{var i=t.scrollTop;t.scrollTop++,i==t.scrollTop&&(e.distance=t.scrollTop,t.scrollTop=0)}}),50))},handlemouseOver:function(){clearInterval(this.timer[this.comp.id])},handlemouseLeave:function(){this.scroll()},utc2beijing:function(e){return Object(o["c"])(e)}}},d=l,u=(a("1ad1"),a("32f9"),a("2877")),v=Object(u["a"])(d,i,n,!1,null,"25e38df5",null);t["a"]=v.exports},"65e4":function(e,t,a){"use strict";a("9b7c")},"6cc1":function(e,t,a){},"780a":function(e,t,a){},7895:function(e,t,a){},"8ba7":function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return r}));var i=a("b775");function n(e){return Object(i["a"])({url:"classes/View",method:"get",params:e})}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])({url:"amis/View/".concat(e),method:"get",params:t})}function c(e){return Object(i["a"])({url:"/topo",method:"get",params:e})}function r(e,t){return Object(i["a"])({url:"/amis",method:"post",params:e,data:t})}},"90be":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll"}],staticClass:"wrap_card",style:{height:e.height}},e._l(e.cardList,(function(t,i){return a("div",{key:i,staticStyle:{height:"auto"}},[a("h2",[e._v(e._s(t.name))]),a("div",{staticClass:"flex_col"},e._l(t.data,(function(t,i){return a("el-card",{key:i,staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.name))])]),a("div",{staticClass:"card_content"},[a("el-avatar",{attrs:{size:50}},[a("img",{attrs:{src:t.imgurl?t.imgurl.indexOf("//")>=0?t.imgurl:e.$FileServe+t.imgurl:e.avator}})]),a("div",{staticClass:"card_content_number",style:{"font-size":e.fontsize||"1em"}},[e._v(" "+e._s(t.number)+" "+e._s(t.unit)+" ")])],1),a("div",{staticClass:"card_bottom"},[e._v(" "+e._s(t.time)+" ")])])})),1)])})),0)},n=[],s={name:"RealCard",props:{cardList:{type:Array,default:function(){return[]}},avator:{type:String},fontsize:{type:String},height:{type:String,default:function(){return"700px"}}}},c=s,r=(a("41cb"),a("2877")),o=Object(r["a"])(c,i,n,!1,null,"5ebf1850",null);t["a"]=o.exports},"90ce":function(e,t,a){},"9a6a":function(e,t,a){"use strict";a("5137")},"9b7c":function(e,t,a){},"9f28":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"topo_content",on:{mouseenter:e.enter,mouseleave:e.leave}},[a("div",{attrs:{id:"deviceTopo"}}),e.vueFlag?a("div",e._l(e.vueComponents,(function(t,i){return a("div",{key:i,staticClass:"vue_component",style:{left:t.x+"px",top:t.y+"px",width:t.width+"px",height:t.height+"px"}},["liveboard"==t.type?a("dgiot-aliplayer",{style:{width:t.width+"px",height:t.height+"px"},attrs:{comp:t}}):"list"==t.type&&"device_list"==t.id?a("screen-device",{style:{width:t.width+"px",height:t.height+"px"},attrs:{comp:t}}):"line"==t.type?a("screen-line",{style:{width:t.width+"px",height:t.height+"px"},attrs:{comp:t,selectdevice:e.deviceInfo}}):"devicebar"==t.type?a("screen-device-bar",{style:{width:t.width+"px",height:t.height+"px"},attrs:{comp:t,selectdevice:e.deviceInfo}}):"list"==t.type&&"warning_list"==t.id?a("topo-caltable",{style:{width:t.width+"px",height:t.height+"px"},attrs:{comp:t}}):"list"==t.type&&"warning_list1"==t.id?a("dgiot-notification1",{style:{width:t.width+"px",height:t.height+"px"},attrs:{comp:t,selectdevice:e.deviceInfo}}):"list"==t.type&&"workorder_list"==t.id?a("work-order",{style:{width:t.width+"px",height:t.height+"px"},attrs:{comp:t}}):"pie"==t.type?a("topo-pie",{style:{width:t.width+"px",height:t.height+"px"},attrs:{comp:t}}):"konvaimage"==t.type?a("img",{style:{width:t.width+"px",height:t.height+"px"},attrs:{src:t.src.includes("//")?t.src:e.$FileServe+t.src}}):e._e()],1)})),0):e._e(),e.amisFlag?a("div",e._l(e.amisComponents,(function(e,t){return a("amis",{key:t,staticClass:"amis_component",style:{left:e.x+"px",top:e.y+"px",width:e.width+"px",height:e.height+"px"},attrs:{"modal-append-to-body":"",schema:e.viewData,"show-help":!1}})})),1):e._e(),e.dialogTopoAmisVisible?a("el-dialog",{attrs:{top:"10vh","append-to-body":!0,width:"1240px",visible:e.dialogTopoAmisVisible},on:{"update:visible":function(t){e.dialogTopoAmisVisible=t},close:e.handlecloseDevice}},[a("amis",{attrs:{"modal-append-to-body":"",schema:e.topoAmisData,"show-help":!1}})],1):e._e()],1)},n=[],s=a("c7eb"),c=a("1da1"),r=(a("ace4"),a("d3b7"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("986a"),a("1d02"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("1b3b"),a("3d71"),a("72f7"),a("c6e3"),a("b64b"),a("159b"),a("7db0"),a("498a"),a("b0c0"),a("14d9"),a("caad"),a("2532"),a("264a")),o=a("c7d9"),l=a("ae53"),d=a("fca4"),u=a("ad0f"),v=a("e6a3"),p=a("a458"),m=a("624b"),h=a("a598"),f=a("e762"),g=a("8ba7"),b=a("39c4"),y={name:"TopoDevice",components:{DgiotAliplayer:r["a"],TopoCaltable:o["a"],ScreenDevice:l["a"],WorkOrder:d["a"],ScreenRealcard:u["a"],Amis:h["a"],ScreenLine:v["a"],ScreenDeviceBar:p["a"],DgiotNotification1:m["a"]},props:{deviceInfo:{type:Object,default:function(){}}},data:function(){return{vueFlag:!1,amisFlag:!1,vueComponents:[],devicestage:{},devicelayer:{},devicetopo:{},dialogTopoAmisVisible:!1,topoAmisData:{}}},mounted:function(){this.vueComponents=[],this.amisComponents=[],this.handleOpenTopo(this.deviceInfo)},methods:{enter:function(){window.addEventListener("mousewheel",this.handleScroll,!0)},leave:function(){window.removeEventListener("mousewheel",this.handleScroll,!0)},handleScroll:function(e){e=e||window.event;document.querySelector(".topo_content")},handleOpenTopo:function(e){var t=this;return Object(c["a"])(Object(s["a"])().mark((function a(){var i,n,c,r,o,l;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return localStorage.setItem("parse_deviceid",e.objectId),n={count:"objectId",order:"createdAt",excludeKeys:"data",skip:0,where:{class:{$regex:"Product"},type:{$regex:"Topo"},key:{$regex:e.product.objectId}}},a.next=4,Object(g["d"])(n);case 4:if(c=a.sent,console.log("组态",c),0!=c.results.length){a.next=9;break}return t.$message("暂未配置组态"),a.abrupt("return");case 9:return r={productid:e.product.objectId,devaddr:e.devaddr,viewid:(null===(i=c.results[0])||void 0===i?void 0:i.objectId)||""},a.next=12,Object(g["a"])(r);case 12:o=a.sent,t.devicetopo=o.data.Stage,l={topic:"$dg/user/konva/".concat(e.objectId,"/report")},console.log("this.deviceInfo",t.deviceInfo),setTimeout((function(){t.initDeviceKonva(),t.sendTopic(l)}),500);case 17:case"end":return a.stop()}}),a)})))()},initDeviceKonva:function(){var e=this;this.devicelayer=Konva.Node.create(this.devicetopo,"deviceTopo").findOne("Layer"),this.devicestage=new Konva.Stage({container:"deviceTopo",width:1200,height:700}),this.devicestage.add(this.devicelayer),this.$dgiotBus.$off("$dg/user/konva"),this.$dgiotBus.$on("$dg/user/konva",(function(t){var a=String.fromCharCode.apply(null,new Uint8Array(t)),i=JSON.parse(f["a"].decode(a));console.log(i),i.konva.forEach((function(t){e.putNode(e.devicestage,t.id,t.text,t.type)}))})),this.handleInitKonva()},putNode:function(e,t,a,i){if("undefined"!=i){var n={};n[i]=a,console.log(t,a),e.find("#".concat(t)).forEach((function(e){console.log(e),e.setAttrs(n)})),this.devicelayer.batchDraw()}},handleInitKonva:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var a,i,n,r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=[],i=[],e.devicestage.find("Label").forEach((function(e){e.setAttrs({draggable:!1})})),e.devicestage.find("Tag").forEach((function(e){e.setAttrs({draggable:!1})})),e.devicestage.find("Text").forEach((function(t){t.setAttrs({draggable:!1}),t.on("touchend",function(){var a=Object(c["a"])(Object(s["a"])().mark((function a(i){var n,c,r;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log("touchend",t),!t.attrs.bind_amis){a.next=11;break}return localStorage.setItem("parse_objectid",e.deviceInfo.objectId),localStorage.setItem("parse_productid",e.deviceInfo.product.objectId),n={viewid:t.attrs.amis_id},c={render:{text:t.attrs.text.trim()}},a.next=8,Object(g["c"])(n,c);case 8:r=a.sent,e.topoAmisData=r.data,e.dialogTopoAmisVisible=!0;case 11:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()),t.on("click",function(){var a=Object(c["a"])(Object(s["a"])().mark((function a(i){var n,c,r;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log("click",t),!t.attrs.bind_amis){a.next=11;break}return localStorage.setItem("parse_objectid",e.deviceInfo.objectId),localStorage.setItem("parse_productid",e.deviceInfo.product.objectId),n={viewid:t.attrs.amis_id},c={render:{text:t.attrs.text.trim()}},a.next=8,Object(g["c"])(n,c);case 8:r=a.sent,e.topoAmisData=r.data,e.dialogTopoAmisVisible=!0;case 11:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())})),e.devicestage.find("Image").forEach((function(t){if(t.setAttrs({draggable:!1}),"konvaimage"==t.attrs.type||"vuecomponent"==t.attrs.name){var n=t.attrs;a.push(n)}else if("amiscomponent"==t.attrs.name){var s=t.attrs;i.push(s)}else if(t.attrs.id.indexOf("不")<0){var c=new Image;t.setAttrs({image:c}),c.src=t.attrs.src.includes("//")?t.attrs.src:e.$FileServe+t.attrs.src}})),e.devicestage.find("Rect").forEach((function(e){if(e.setAttrs({draggable:!1}),"vuecomponent"==e.attrs.name){var t=e.attrs;a.push(t)}else if("amiscomponent"==e.attrs.name){var n=e.attrs;i.push(n)}})),e.devicelayer.batchDraw(),setTimeout((function(){console.log("第一次重绘"),e.devicelayer.batchDraw()}),500),setTimeout((function(){console.log("第二次重绘"),e.devicelayer.batchDraw()}),1e3),setTimeout((function(){console.log("第三次重绘"),e.devicelayer.batchDraw()}),1e3),e.vueComponents=a,e.vueFlag=!0,e.amisComponents=i,n=0;case 15:if(!(n<e.amisComponents.length)){t.next=23;break}return t.next=18,Object(g["b"])(e.amisComponents[n].id);case 18:r=t.sent,e.amisComponents[n].viewData=r.data.data;case 20:n++,t.next=15;break;case 23:e.amisFlag=!0;case 24:case"end":return t.stop()}}),t)})))()},sendTopic:function(e){Object(b["d"])(e).then((function(e){console.log(e)}))}}},w=y,_=(a("2dac"),a("2877")),C=Object(_["a"])(w,i,n,!1,null,"6b75dfc8",null);t["a"]=C.exports},a0e0:function(e,t,a){e.exports=a.p+"static/img/realtime.3c94ab99.png"},a458:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"topoBar",style:{width:"100%",height:"100%"}},[a("div",{staticClass:"title"},[e._v("历史数据")]),a("div",{staticClass:"line_top"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.couponSelected,expression:"couponSelected"}],staticClass:"select_time",attrs:{name:"public-choice"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.couponSelected=t.target.multiple?a:a[0]},function(t){return e.getCouponSelected(t)}]}},e._l(e.selecttime,(function(t){return a("option",{key:t.id,staticClass:"select_option",domProps:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),0)]),a("div",{staticClass:"line_name"},[e._v(" "+e._s(e.selectItem.name)+" ")]),a("div",{staticClass:"line_content"},[a("ve-histogram",{attrs:{data:e.chartData,extend:e.extend,height:"100%",settings:e.chartSettings,width:"100%"}})],1)])},n=[],s=a("c7eb"),c=a("1da1"),r=a("1285"),o={name:"ScreenLine",props:{comp:{type:Object,default:function(){return{type:"line",width:200,hieght:120}}},viewtype:{type:String,default:function(){return""}},selectdevice:{type:Object,default:function(){return{}}}},data:function(){return this.chartSettings={},this.extend={series:{type:"bar",itemStyle:{borderRadius:2,borderColor:"#fff",borderWidth:1}},legend:{textStyle:{color:"#fff"}},xAxis:{type:"category",show:!0,axisLine:{lineStyle:{color:"#fff"}}},yAxis:{type:"value",axisLabel:{color:"#fff"}},grid:{left:10,right:0,width:"96%",height:"80%"},dataZoom:[{type:"inside"}]},{couponSelected:"m",chartData:{columns:[],rows:[]},timer:"",selecttime:[{value:"s",name:"1天",id:"10000001"},{value:"m",name:"7天",id:"10000002"},{value:"h",name:"30天",id:"10000004"},{value:"w",name:"365天",id:"10000005"}],queryData:{},selectItem:{}}},mounted:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var a,i;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a={skip:0,limit:5,order:"-updatedAt",count:"objectId",where:{}},t.prev=1,"Dashboard"!=e.viewtype){t.next=10;break}return t.next=5,Object(r["e"])(a);case 5:i=t.sent,console.log("历史数据",i),i.results&&i.results.length>=1&&(e.selectItem=i.results[0],e.getHistoryData(e.couponSelected)),t.next=12;break;case 10:e.selectItem=e.selectdevice,e.getHistoryData(e.couponSelected);case 12:t.next=16;break;case 14:t.prev=14,t.t0=t["catch"](1);case 16:e.$dgiotBus.$off("device/historybardata"),e.$dgiotBus.$on("device/historybardata",(function(t){console.log("接受",t),e.selectItem=t,e.getHistoryData(e.couponSelected)}));case 18:case"end":return t.stop()}}),t,null,[[1,14]])})))()},methods:{getDay:function(e){switch(e){case"s":return 1;case"m":return 7;case"h":return 30;case"w":return 365}},getCouponSelected:function(e){console.log(e.target.value);e.target.value;console.log(this.couponSelected),this.getHistoryData(this.couponSelected)},getHistoryData:function(e){var t=this;return Object(c["a"])(Object(s["a"])().mark((function a(){var i,n;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=t.getDay(e),n={starttime:(new Date).getTime()-864e5*i,endtime:(new Date).getTime(),interval:"1"+e,keys:"*",limit:100,function:"last",style:"line"},a.next=4,Object(r["c"])(t.selectItem.objectId,n).then((function(e){var a;if((null===e||void 0===e||null===(a=e.chartData)||void 0===a?void 0:a.rows.length)>0){var i=e.chartData,n=void 0===i?{}:i;t.chartData=n}else t.chartData={columns:[],rows:[]}}));case 4:case"end":return a.stop()}}),a)})))()}}},l=o,d=(a("65e4"),a("2877")),u=Object(d["a"])(l,i,n,!1,null,"4890d112",null);t["a"]=u.exports},aa47:function(e,t,a){"use strict";a("2202")},ad0f:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ScreenRealcard"},[a("div",{staticClass:"bg-color-black"},[e._m(0),a("div",{staticClass:"jc-center"},[a("div",{staticClass:"flex_left"},[e._m(1),a("div",{staticClass:"jc-center-content"},e._l(e.deviceList,(function(t,i){return a("div",{key:i,staticClass:"flex-item",class:{deviceActive:i==e.currentIndex},on:{click:function(a){return e.handleDeviceCheck(t,i)}}},[a("div",{staticClass:"flex_item_2",staticStyle:{"z-index":"99999"}},[a("el-tooltip",{attrs:{content:t.name,effect:"dark",placement:"top"}},[a("span",[e._v(e._s(t.name))])])],1),a("div",{staticClass:"flex_item_1"},["OFFLINE"==t.status?a("span",{staticStyle:{color:"#f00"}},[e._v("离线")]):a("span",{staticStyle:{color:"#26db6f"}},[e._v("在线")])])])})),0)]),a("div",{staticClass:"flex_right"},e._l(e.cardList,(function(t,i){return a("div",{key:i,staticClass:"flex_rt_item1"},[a("div",{staticClass:"flex_rt_item_ct"},[e._m(2,!0),a("div",{staticClass:"flex_rt_item_ct_real"},[a("div",{staticClass:"ct_real_name"},[e._v(e._s(t.name))]),a("div",{staticClass:"ct_real_number"},[e._v(" "+e._s(t.number)+e._s(t.unit)+" ")]),a("div",{staticClass:"ct_real_time"},[e._v(e._s(t.time))])])])])})),0)])]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.productSelected,expression:"productSelected"}],staticClass:"select_time",attrs:{name:"public-choice"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.productSelected=t.target.multiple?a:a[0]},function(t){return e.getCouponSelected(t)}]}},e._l(e.productlist,(function(t){return a("option",{key:t.objectId,staticClass:"select_option",domProps:{value:t.objectId}},[e._v(" "+e._s(t.name)+" ")])})),0)])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pt-2 pl-2"},[a("div",{staticClass:"d-flex"},[a("span",{staticClass:"fs-xl text mx-2"},[e._v("设备列表")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex-item"},[a("div",{staticClass:"flex_item_2"},[e._v("设备名称")]),a("div",{staticClass:"flex_item_1"},[e._v("设备状态")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"flex_rt_item_ct_img"},[i("img",{attrs:{src:a("a0e0"),alt:""}})])}],s=a("5530"),c=(a("e9c4"),a("b0c0"),a("d81d"),a("d3b7"),a("159b"),a("14d9"),a("2f62")),r={props:{markers:{type:Array,default:function(){return[]}}},components:{},computed:Object(s["a"])(Object(s["a"])({},Object(c["c"])(["realCard"])),{},{realCard1:function(){return this.realCard}}),watch:{realCard1:function(e){console.log("newData",e),this.cardList=e}},data:function(){return{nowselect:"",currentIndex:0,cardList:[{name:"温度",number:"1212121",unit:"%",time:"2022-11-01 15:40:21"},{name:"温度",number:"1",unit:"%",time:"2022-11-01 15:40:21"},{name:"温度",number:"1",unit:"%",time:"2022-11-01 15:40:21"},{name:"温度",number:"1",unit:"%",time:"2022-11-01 15:40:21"}],productlist:[{name:"产品1",objectId:"afhaifha"}],productSelected:"ALL",isActive:!0,show:!1,activeName:"",deviceList:[{name:"设备1",status:"OFFLINE"},{name:"设备2",status:"ONLINE"},{name:"设备1",status:"OFFLINE"},{name:"设备2",status:"ONLINE"},{name:"设备1",status:"OFFLINE"},{name:"设备2",status:"ONLINE"}],realData:[]}},mounted:function(){console.log("markers",this.markers),console.log("产品列表",this.productlist),window.addEventListener("mousewheel",this.handleScroll,!1),window.addEventListener("DOMMouseScroll",this.handleScroll,!1)},methods:{getCouponSelected:function(e){console.log(e.target.value);var t=e.target.value;this.currentIndex=-1,console.log("objectId产品编号",t),this.$emit("updateDevice",t)},isObjectChanged:function(e,t){var a=JSON.stringify(e),i=JSON.stringify(Object(s["a"])(Object(s["a"])({},e),t));return a!==i},updateAddress:function(e){console.log("这是value",e)},handleChange:function(e){console.log("这是设备",e);var t={basedata:e.basedata,detail:e.detail,devaddr:e.devaddr,name:e.name};updateDevice(e.objectId,t).then((function(e){console.log("修改成功",e)}))},handleSizeOfMap:function(){this.isActive=!this.isActive},handleZoom:function(e){var t=e.type,a=e.target;console.log(t,a),this.center={lat:a.re.lat,lng:a.re.lng}},handler:function(e){var t=e.BMap,a=e.map,i=this;console.log("百度地图",t,a),a.addEventListener("zoomstart",(function(){i.center.lng=a.getCenter().lng,i.center.lat=a.getCenter().lat})),a.addEventListener("zoomend",(function(){a.centerAndZoom(new t.Point(i.center.lng,i.center.lat),a.getZoom())}))},infoWindowClose:function(){console.log("111"),this.show=!1},handleDeviceCheck:function(e,t){var a=this,i=e.name,n=e.objectId;this.realData=[],this.$store.commit("updateObjectId",n),getnowData(e.objectId).then((function(e){var t=[];e.data.forEach((function(e){"温湿度"!=e.name&&t.push(e)})),t.forEach((function(e){"水浸"==e.name?e.number=1==e.number?"正常":"异常":"烟感"==e.name&&(e.number=0==e.number?"正常":"异常")})),a.cardList=t,a.$emit("getrealdata",t,i)})),this.currentIndex=t,this.$emit("deviceclick",n,i)}}},o=r,l=(a("1b4a"),a("f8e3"),a("2877")),d=Object(l["a"])(o,i,n,!1,null,"650ddfae",null);t["a"]=d.exports},ae53:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"topoCaltable",style:{width:"100%",height:"100%"}},[a("div",{staticClass:"table_content"},[a("div",{staticClass:"backround"},[e._m(0),a("div",{staticClass:"table_parent",on:{mouseover:e.handlemouseOver,mouseleave:e.handlemouseLeave}},[a("table",{staticClass:"table",attrs:{cellpadding:"0",cellspacing:"0"}},e._l(e.deviceList,(function(t,i){return a("tr",{key:i,staticClass:"table-item",class:t.objectId==e.selectObjectId?"table-item-select":"",on:{click:function(a){return e.handleCheckDevice(t)}}},[a("td",{staticClass:"table-item-content"},[e._v(e._s(t.name))]),a("td",{staticClass:"table-item-content"},[e._v(" "+e._s(t.address)+" ")]),a("td",{staticClass:"table-item-content"},["OFFLINE"==t.status?a("el-tag",{attrs:{size:"medium",type:"warning"}},[e._v(" 离线 ")]):a("el-tag",{attrs:{size:"medium",type:"success"}},[e._v("在线")])],1),a("td",{staticClass:"table-item-content"},[e._v(" "+e._s(e.utc2beijing(t.updatedAt))+" ")]),a("td",{staticClass:"table-item-content"},[a("div",{staticClass:"item_btn",on:{click:function(a){return e.handleOpenRealCard(t)}}},[e._v(" 数据 ")])])])})),0)])]),a("el-dialog",{staticClass:"device_wrap",attrs:{title:e.deviceInfo.name,"append-to-body":!0,top:"10vh",visible:e.dialogDeviceVisible},on:{close:e.handlecloseDevice,"update:visible":function(t){e.dialogDeviceVisible=t}}},[a("real-card",{attrs:{cardList:e.cardList,avator:e.avator}})],1)],1),a("div",{staticClass:"screen_right_bottom"},[a("el-pagination",{attrs:{small:"",background:"","current-page":e.currentPage,"pager-count":5,layout:"prev, pager, next",total:e.total},on:{"current-change":e.handlePage}})],1)])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"toptitle"},[a("div",{staticClass:"item"},[e._v("设备名称")]),a("div",{staticClass:"item"},[e._v("安装位置")]),a("div",{staticClass:"item"},[e._v("状态")]),a("div",{staticClass:"item"},[e._v("更新时间")]),a("div",{staticClass:"item"},[e._v("操作")])])}],s=a("2909"),c=a("c7eb"),r=a("1da1"),o=(a("d3b7"),a("159b"),a("ace4"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("986a"),a("1d02"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("1b3b"),a("3d71"),a("72f7"),a("c6e3"),a("b64b"),a("14d9"),a("6062"),a("3ca3"),a("ddb0"),a("b0c0"),a("2f62"),a("59d7")),l=a.n(o),d=a("1285"),u=a("90be"),v=a("ed08"),p={name:"ScreenDevice",props:{comp:{type:Object,default:function(){return{type:"line",width:400,hieght:72}}}},components:{RealCard:u["a"]},data:function(){return{isCreated:!0,avator:l.a,selectObjectId:"",status:!1,listData:[],warnList:[],deviceList:[],currentPage:1,skip:0,total:0,queryForm:{devicename:"",statusFlag:!1,status:"",number:"",product:"",type:"",pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,order:"-createdAt",keys:"count(*)"},distance:"",timer:{},cardList:[],dialogDeviceVisible:!1,deviceInfo:{}}},computed:{optionHover:function(){return{step:.5,limitMoveNum:4,hoverStop:!0,direction:1,openWatch:!0,singleHeight:0,singleWidth:0,waitTime:1e3}}},created:function(){this.fetchData()},mounted:function(){var e=this;setTimeout((function(){e.scroll()}),1e3)},methods:{handlePage:function(e){console.log(e,this.currentPage),this.currentPage=e,this.skip=10*(e-1),this.fetchData()},handleCheckDevice:function(e){this.selectObjectId=e.objectId,this.$dgiotBus.$emit("device/transmit",e),this.$dgiotBus.$emit("device/historylinedata",e),this.$dgiotBus.$emit("device/historybardata",e)},scroll:function(){var e=this,t=document.getElementsByClassName("table_parent")[0],a=document.getElementsByClassName("table")[0];console.log("盒子高度",t.clientHeight,a.scrollHeight),a.scrollHeight>1.5*t.clientHeight&&(clearInterval(this.timer),this.timer[e.comp.type]=setInterval((function(){if(t.scrollTop>=a.scrollHeight)t.scrollTop=0;else{var i=t.scrollTop;t.scrollTop++,i==t.scrollTop&&(e.distance=t.scrollTop,t.scrollTop=0)}}),20))},fetchData:function(){var e=this;return Object(r["a"])(Object(c["a"])().mark((function t(){var a,i,n,s,r,o;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={skip:e.skip,limit:10,order:"-updatedAt",count:"objectId",where:{}},t.next=3,Object(d["e"])(a,e.token);case 3:i=t.sent,n=i.results,s=void 0===n?[]:n,r=i.count,o=void 0===r?0:r,e.total=o,s.forEach((function(e){e.address=""==e.address||void 0==e.address?"---":e.address})),s.length>0&&e.isCreated&&(e.selectObjectId=s[0].objectId,e.isCreated=!1),e.deviceList=s,e.total=o,e.listLoading=!1;case 14:case"end":return t.stop()}}),t)})))()},handlemouseOver:function(){clearInterval(this.timer[this.comp.type])},handlemouseLeave:function(){this.scroll()},utc2beijing:function(e){return Object(v["c"])(e)},handleOpenRealCard:function(e){var t=this;return Object(r["a"])(Object(c["a"])().mark((function a(){var i;return Object(c["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.deviceInfo=e,a.next=3,Object(d["b"])(e.objectId);case 3:i=a.sent,t.cardList=t.renderCard(i.data),console.log("thiscardList",t.cardList),t.dialogDeviceVisible=!0,t.$dgiotBus.$off("$dg/user/realtimecard/".concat(e.objectId)),t.$dgiotBus.$on("$dg/user/realtimecard/".concat(e.objectId),(function(e){var a=String.fromCharCode.apply(null,new Uint8Array(e)),i=JSON.parse(Base64.decode(a));console.log("实时卡片 ",i),t.cardList=t.renderCard(i.data)}));case 9:case"end":return a.stop()}}),a)})))()},handlecloseDevice:function(){this.$dgiotBus.$off("$dg/user/realtimecard/".concat(this.deviceInfo.objectId)),console.log("关闭实时数据弹窗"),this.$emit("initScreen")},renderCard:function(e){var t=[];e.forEach((function(e){e.devicetype=""===e.devicetype?"default":e.devicetype,e.devicetype&&t.push(e.devicetype)})),t=Object(s["a"])(new Set(t));var a=[];return t.forEach((function(t){var i={},n=[];e.forEach((function(e){t==e.devicetype&&n.push(e)})),i["data"]=n,i["name"]=t,a.push(i)})),a}}},m=p,h=(a("0815"),a("bcba"),a("2877")),f=Object(h["a"])(m,i,n,!1,null,"6ae8e76d",null);t["a"]=f.exports},bcba:function(e,t,a){"use strict";a("780a")},c734:function(e,t,a){},c764:function(e,t,a){},c7d9:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"topoCaltable",style:{width:"100%",height:"100%"}},[a("div",{staticClass:"screen_right_bottom_top"},[e._v("告警信息列表")]),a("div",{staticClass:"table_content"},[a("div",{staticClass:"backround"},[e._m(0),a("div",{staticClass:"warning_parent",on:{mouseover:e.handlemouseOver,mouseleave:e.handlemouseLeave}},[a("table",{staticClass:"table_warning",attrs:{cellpadding:"0",cellspacing:"0"}},e._l(e.warnList,(function(t,i){return a("tr",{key:i,staticClass:"table-item"},[a("td",{staticClass:"table-item-content"},[e._v(e._s(t.devicename))]),a("td",{staticClass:"table-item-content"},[e._v(" "+e._s(e.utc2beijing(t.createdAt))+" ")]),a("td",{staticClass:"table-item-content"},[t.content.alertstatus?a("el-tag",{attrs:{size:"medium",type:"warning"}},[e._v(" 告警产生 ")]):a("el-tag",{attrs:{size:"medium",type:"success"}},[e._v("告警恢复")])],1),a("td",{staticClass:"table-item-content"},[e._v(e._s(t.desc))])])})),0)])])])])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"toptitle"},[a("div",{staticClass:"item"},[e._v("设备名称")]),a("div",{staticClass:"item"},[e._v("报警时间")]),a("div",{staticClass:"item"},[e._v("状态")]),a("div",{staticClass:"item"},[e._v("告警内容")])])}],s=a("c7eb"),c=a("1da1"),r=(a("d3b7"),a("159b"),a("2f62"),a("4569")),o=a("ed08"),l={name:"TopoCaltable",props:{comp:{type:Object,default:function(){return{type:"line",width:400,hieght:72}}}},data:function(){return{status:!1,listData:[],warnList:[],queryPayload:{order:"-createdAt",page:1,perPage:10,count:"objectId"},timer:{},distance:""}},computed:{optionHover:function(){return{step:.5,limitMoveNum:5,hoverStop:!0,direction:1,openWatch:!0,singleHeight:0,singleWidth:0,waitTime:1e3}}},created:function(){this.fetchData()},mounted:function(){var e=this;setTimeout((function(){e.scroll()}),1500)},methods:{fetchData:function(){var e=arguments,t=this;return Object(c["a"])(Object(s["a"])().mark((function a(){var i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.length>0&&void 0!==e[0]?e[0]:{},a.next=3,Object(r["b"])(t.queryPayload);case 3:i=a.sent,i.data.items.forEach((function(e){var t,a;e.devicename=e.devicename||(null===(t=e.content)||void 0===t?void 0:t.devicename)||"",e.desc=e.desc||(null===(a=e.content)||void 0===a?void 0:a.errorname)||""})),t.warnList=i.data.items;case 6:case"end":return a.stop()}}),a)})))()},scroll:function(){var e=this,t=document.getElementsByClassName("warning_parent")[0],a=document.getElementsByClassName("table_warning")[0];a.scrollHeight>1.5*t.clientHeight&&(clearInterval(this.timer),this.timer[e.comp.id]=setInterval((function(){if(t.scrollTop>=a.scrollHeight)t.scrollTop=0;else{var i=t.scrollTop;t.scrollTop++,i==t.scrollTop&&(e.distance=t.scrollTop,t.scrollTop=0)}}),20))},handlemouseOver:function(){clearInterval(this.timer[this.comp.id])},handlemouseLeave:function(){this.scroll()},utc2beijing:function(e){return Object(o["c"])(e)}}},d=l,u=(a("c911"),a("e153"),a("2877")),v=Object(u["a"])(d,i,n,!1,null,"26228f40",null);t["a"]=v.exports},c911:function(e,t,a){"use strict";a("7895")},e05a7:function(e,t,a){},e153:function(e,t,a){"use strict";a("c764")},e3cf:function(e,t,a){},e528:function(e,t,a){},e6a3:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"topoLine",style:{width:"100%",height:"100%"}},[a("div",{staticClass:"title"},[e._v("历史数据")]),a("div",{staticClass:"line_top"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.couponSelected,expression:"couponSelected"}],staticClass:"select_time",attrs:{name:"public-choice"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.couponSelected=t.target.multiple?a:a[0]},function(t){return e.getCouponSelected(t)}]}},e._l(e.selecttime,(function(t){return a("option",{key:t.id,staticClass:"select_option",domProps:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),0)]),a("div",{staticClass:"line_name"},[e._v(" "+e._s(e.selectItem.name)+" ")]),a("div",{staticClass:"line_content"},[a("ve-line",{attrs:{data:e.chartData,extend:e.extend,height:"100%",settings:e.chartSettings,width:"100%"}})],1)])},n=[],s=a("c7eb"),c=a("1da1"),r=a("1285"),o={name:"ScreenLine",props:{comp:{type:Object,default:function(){return{type:"line",width:200,hieght:120}}},viewtype:{type:String,default:function(){return""}},selectdevice:{type:Object,default:function(){return{}}}},data:function(){return this.chartSettings={labelAlias:{PV:"访问用户",Order:"下单用户"}},this.extend={series:{type:"line",showAllSymbol:!0,symbol:"none",smooth:!0,itemStyle:{borderRadius:2,borderColor:"#fff",borderWidth:1}},legend:{textStyle:{color:"#fff"}},xAxis:{nameTextStyle:{color:"#fff"},axisLine:{lineStyle:{color:"#fff"}}},yAxis:{show:!0,axisLine:{lineStyle:{color:"#ccc"},textStyle:{color:"#fff"}},axisLabel:{color:"#fff"}},grid:{left:10,right:0,bottom:0,width:"96%",height:"80%"},dataZoom:[{type:"inside"}]},{couponSelected:"m",chartData:{columns:[],rows:[]},timer:"",selecttime:[{value:"s",name:"1天",id:"10000001"},{value:"m",name:"7天",id:"10000002"},{value:"h",name:"30天",id:"10000004"},{value:"w",name:"365天",id:"10000005"}],queryData:{},selectItem:{}}},mounted:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var a,i;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a={skip:0,limit:5,order:"-updatedAt",count:"objectId",where:{}},t.prev=1,"Dashboard"!=e.viewtype){t.next=10;break}return t.next=5,Object(r["e"])(a);case 5:i=t.sent,console.log("历史数据",i),i.results&&i.results.length>=1&&(e.selectItem=i.results[0],e.getHistoryData(e.couponSelected)),t.next=12;break;case 10:e.selectItem=e.selectdevice,e.getHistoryData(e.couponSelected);case 12:t.next=16;break;case 14:t.prev=14,t.t0=t["catch"](1);case 16:e.$dgiotBus.$off("device/historylinedata"),e.$dgiotBus.$on("device/historylinedata",(function(t){console.log("接受",t),e.selectItem=t,e.getHistoryData(e.couponSelected)}));case 18:case"end":return t.stop()}}),t,null,[[1,14]])})))()},methods:{getDay:function(e){switch(e){case"s":return 1;case"m":return 7;case"h":return 30;case"w":return 365}},getCouponSelected:function(e){console.log(e.target.value);e.target.value;console.log(this.couponSelected),this.getHistoryData(this.couponSelected)},getHistoryData:function(e){var t=this;return Object(c["a"])(Object(s["a"])().mark((function a(){var i,n;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=t.getDay(e),n={starttime:(new Date).getTime()-864e5*i,endtime:(new Date).getTime(),interval:"1"+e,keys:"*",limit:100,function:"last",style:"line"},a.next=4,Object(r["c"])(t.selectItem.objectId,n).then((function(e){var a;if((null===e||void 0===e||null===(a=e.chartData)||void 0===a?void 0:a.rows.length)>0){var i=e.chartData,n=void 0===i?{}:i;t.chartData=n}else t.chartData={columns:[],rows:[]}}));case 4:case"end":return a.stop()}}),a)})))()}}},l=o,d=(a("2c89"),a("2877")),u=Object(d["a"])(l,i,n,!1,null,"6c62611c",null);t["a"]=u.exports},ed08:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return c}));a("53ca"),a("ac1f"),a("00b4"),a("5319"),a("4d63"),a("c607"),a("2c3e"),a("25f0"),a("d3b7"),a("4d90"),a("159b");function i(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t}function n(){for(var e=navigator.userAgent,t=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),a=!0,i=0;i<t.length;i++)if(e.indexOf(t[i])>0){a=!1;break}return a}function s(e){return e<10?"0"+e:e}function c(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1;a=s(a);var i=e.getDate();i=s(i);var n=e.getHours();n=s(n);var c=e.getMinutes();c=s(c);var r=e.getSeconds();r=s(r);var o=t+"-"+a+"-"+i+" "+n+":"+c+":"+r;return o}},f888:function(e,t,a){"use strict";a("178e")},f8e3:function(e,t,a){"use strict";a("015f")},fca4:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"topoCaltable",style:{width:"100%",height:"100%"}},[a("div",{staticClass:"screen_right_bottom_top"},[e._v("工单列表")]),a("div",{staticClass:"table_content"},[a("div",{staticClass:"backround"},[e._m(0),a("div",{staticClass:"workorder_parent",on:{mouseover:e.handlemouseOver,mouseleave:e.handlemouseLeave}},[a("table",{staticClass:"table_workorder",attrs:{cellpadding:"0",cellspacing:"0"}},e._l(e.orderList,(function(t,i){return a("tr",{key:i,staticClass:"table-item"},[a("td",{staticClass:"table-item-content"},[e._v(e._s(t.number))]),a("td",{staticClass:"table-item-content"},[e._v(e._s(t.type))]),a("td",{staticClass:"table-item-content"},[e._v(" "+e._s(e.utc2beijing(t.createdAt))+" ")]),a("td",{staticClass:"table-item-content"},[a("el-tag",{attrs:{size:"medium",type:0==t.status?"danger":1==t.status?"":2==t.status?"success":"warning"}},[e._v(" "+e._s(e.getStatus(t.status))+" ")])],1)])})),0)])])])])},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"toptitle"},[a("div",{staticClass:"item"},[e._v("工单编号")]),a("div",{staticClass:"item"},[e._v("工单类型")]),a("div",{staticClass:"item"},[e._v("创建时间")]),a("div",{staticClass:"item"},[e._v("工单状态")])])}],s=a("c7eb"),c=a("1da1"),r=(a("2f62"),a("d76c")),o=a("ed08"),l={name:"WorkOrder",props:{comp:{type:Object,default:function(){return{type:"line",width:400,hieght:72}}}},data:function(){return{status:!1,listData:[],orderList:[],queryPayload:{limit:10,order:"-createdAt",skip:0,count:"objectId"},queryForm:{devicename:"",statusFlag:!1,status:"",number:"",product:"",type:"",pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,order:"-createdAt",keys:"count(*)"},timer:{},distance:""}},computed:{},created:function(){this.fetchData()},mounted:function(){var e=this;setTimeout((function(){e.scroll()}),1500)},methods:{fetchData:function(){var e=arguments,t=this;return Object(c["a"])(Object(s["a"])().mark((function a(){var i,n;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=e.length>0&&void 0!==e[0]?e[0]:{},i.limit||(i=t.queryForm),t.listLoading=!1,n={limit:10,order:"-createdAt",skip:0,count:"objectId",where:{user:t.objectid,status:{$lt:3}}},a.next=6,Object(r["a"])(n).then((function(e){var a=e.results,i=void 0===a?[]:a,n=e.count,s=void 0===n?0:n;t.orderList=i,t.total=s})).catch((function(e){t.$baseMessage(e,"error","dgiot-hey-message-error")}));case 6:case"end":return a.stop()}}),a)})))()},getStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case 0:return"待接收";case 1:return"处理中";case 2:return"已处理";case 3:return"已回退";default:return e}},scroll:function(){var e=this,t=document.getElementsByClassName("workorder_parent")[0],a=document.getElementsByClassName("table_workorder")[0];a.scrollHeight>1.5*t.clientHeight&&(clearInterval(this.timer),this.timer[e.comp.id]=setInterval((function(){if(t.scrollTop>=a.scrollHeight)t.scrollTop=0;else{var i=t.scrollTop;t.scrollTop++,i==t.scrollTop&&(e.distance=t.scrollTop,t.scrollTop=0)}}),20))},handlemouseOver:function(){clearInterval(this.timer[this.comp.id])},handlemouseLeave:function(){this.scroll()},utc2beijing:function(e){return Object(o["c"])(e)}}},d=l,u=(a("9a6a"),a("aa47"),a("2877")),v=Object(u["a"])(d,i,n,!1,null,"0428ca53",null);t["a"]=v.exports}}]);